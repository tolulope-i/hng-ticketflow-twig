<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}TicketFlow - Twig{% endblock %}</title>
<link rel="stylesheet" href="/assets/styles/global.css?v={{ random() }}">
<style>
        .nav-toggle .hamburger-icon,
        .nav-toggle .cancel-icon {
            font-size: 1.5rem;
            transition: opacity 0.3s ease;
        }
        
        .nav-toggle .cancel-icon {
            font-size: 1.8rem;
            font-weight: bold;
        }

        
    </style>
</head>
<body>
    {% block header %}
    <header class="header">
        <div class="container">
            <nav class="nav" role="navigation">
                <a href="/" class="logo" aria-label="TicketFlow Home">TicketFlow</a>
                
                <button class="nav-toggle" onclick="toggleMenu()" aria-expanded="false" aria-label="Toggle navigation menu">
                    <span class="hamburger-icon">&#9776;</span>
                    <span class="cancel-icon" style="display: none;">&times;</span>
                </button>

                <ul class="nav-links" id="navLinks">
                    {% if user %}
                        <li><a href="/dashboard" class="nav-link">Dashboard</a></li>
                        <li><a href="/tickets" class="nav-link">Tickets</a></li>
                        <li><a href="/logout" class="btn btn-outline btn-sm">Logout</a></li>
                    {% else %}
                        <li><a href="/auth/login" class="nav-link">Login</a></li>
                        <li><a href="/auth/signup" class="btn btn-primary btn-sm">Get Started</a></li>
                    {% endif %}
                </ul>
            </nav>
        </div>
    </header>

    <script>
        function toggleMenu() {
            const navLinks = document.getElementById('navLinks');
            const navToggle = document.querySelector('.nav-toggle');
            const hamburgerIcon = document.querySelector('.hamburger-icon');
            const cancelIcon = document.querySelector('.cancel-icon');
            const isExpanded = navLinks.classList.contains('active');
            
            navLinks.classList.toggle('active');
            
            if (isExpanded) {
                // Closing menu - show hamburger
                hamburgerIcon.style.display = 'block';
                cancelIcon.style.display = 'none';
                navToggle.setAttribute('aria-label', 'Open navigation menu');
                navToggle.setAttribute('aria-expanded', 'false');
            } else {
                // Opening menu - show cancel
                hamburgerIcon.style.display = 'none';
                cancelIcon.style.display = 'block';
                navToggle.setAttribute('aria-label', 'Close navigation menu');
                navToggle.setAttribute('aria-expanded', 'true');
            }
        }

        function closeMenu() {
            const navLinks = document.getElementById('navLinks');
            const navToggle = document.querySelector('.nav-toggle');
            const hamburgerIcon = document.querySelector('.hamburger-icon');
            const cancelIcon = document.querySelector('.cancel-icon');
            
            navLinks.classList.remove('active');
            hamburgerIcon.style.display = 'block';
            cancelIcon.style.display = 'none';
            navToggle.setAttribute('aria-label', 'Open navigation menu');
            navToggle.setAttribute('aria-expanded', 'false');
        }

        // Close menu when clicking outside
        document.addEventListener('click', function(event) {
            const nav = document.querySelector('.nav');
            const navToggle = document.querySelector('.nav-toggle');
            const navLinks = document.getElementById('navLinks');
            
            if (!nav.contains(event.target) && navLinks.classList.contains('active')) {
                closeMenu();
            }
        });

        // Close menu on escape key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeMenu();
            }
        });
    </script>
    {% endblock %}

    <main>
        {% block content %}{% endblock %}
    </main>

    {% if success %}
    <div class="toast toast-success" role="alert" aria-live="polite">
        <span>{{ success }}</span>
        <button onclick="this.parentElement.remove()" class="btn btn-sm" style="background: transparent; border: none; font-size: 1.25rem; padding: 0" aria-label="Close notification">×</button>
    </div>
    {% endif %}

    {% if error %}
    <div class="toast toast-error" role="alert" aria-live="polite">
        <span>{{ error }}</span>
        <button onclick="this.parentElement.remove()" class="btn btn-sm" style="background: transparent; border: none; font-size: 1.25rem; padding: 0" aria-label="Close notification">×</button>
    </div>
    {% endif %}
</body>
</html>